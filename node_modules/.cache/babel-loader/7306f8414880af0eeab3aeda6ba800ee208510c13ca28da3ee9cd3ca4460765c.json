{"ast":null,"code":"import React, { useState, useEffect, useContext } from 'react';\nimport { useAuth0, Auth0Provider } from '@auth0/auth0-react';\nvar defaultAuthState = {\n  isLoading: false,\n  isAuthenticated: false,\n  user: null,\n  roleAssignments: null,\n  getAccessToken: function getAccessToken() {\n    return Promise.resolve('');\n  },\n  logout: function logout() {},\n  login: function login() {}\n};\nfunction createAuthContext() {\n  return React.createContext(defaultAuthState);\n}\nvar AuthContext = createAuthContext();\nvar Auth0AuthProvider = function Auth0AuthProvider(_ref) {\n  var children = _ref.children,\n    claimsNamespace = _ref.claimsNamespace,\n    loginAutomatically = _ref.loginAutomatically;\n  var _useAuth = useAuth0(),\n    isLoading = _useAuth.isLoading,\n    isAuthenticated = _useAuth.isAuthenticated,\n    user = _useAuth.user,\n    loginWithRedirect = _useAuth.loginWithRedirect,\n    getIdTokenClaims = _useAuth.getIdTokenClaims,\n    getAccessTokenSilently = _useAuth.getAccessTokenSilently,\n    logout = _useAuth.logout;\n  var _useState = useState(),\n    roleAssignments = _useState[0],\n    setRoleAssignments = _useState[1];\n  useEffect(function () {\n    var getClaims = function getClaims() {\n      try {\n        return Promise.resolve(getIdTokenClaims()).then(function (idTokenClaims) {\n          if (idTokenClaims) {\n            setRoleAssignments(idTokenClaims[claimsNamespace]);\n          }\n        });\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    if (isAuthenticated && claimsNamespace !== undefined) {\n      getClaims();\n    }\n  }, [isAuthenticated, getIdTokenClaims]);\n  if (!isAuthenticated && !isLoading) {\n    if (loginAutomatically) {\n      loginWithRedirect();\n    }\n  }\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      isLoading: isLoading,\n      user: user,\n      roleAssignments: roleAssignments,\n      getAccessToken: getAccessTokenSilently,\n      logout: logout,\n      login: function login(redirectUri) {\n        return loginWithRedirect({\n          redirectUri: redirectUri\n        });\n      }\n    }\n  }, children);\n};\nvar AuthProvider = function AuthProvider(_ref) {\n  var auth0Config = _ref.auth0Config,\n    auth0ClaimsNamespace = _ref.auth0ClaimsNamespace,\n    children = _ref.children,\n    _ref$loginAutomatical = _ref.loginAutomatically,\n    loginAutomatically = _ref$loginAutomatical === void 0 ? true : _ref$loginAutomatical;\n  return React.createElement(Auth0Provider, Object.assign({\n    useRefreshToken: true,\n    cacheLocation: window.location.hostname.indexOf('localhost') > -1 ? 'localstorage' : 'memory'\n  }, auth0Config), React.createElement(Auth0AuthProvider, {\n    claimsNamespace: auth0ClaimsNamespace,\n    loginAutomatically: loginAutomatically\n  }, children));\n};\nvar useAuth = function useAuth() {\n  return useContext(AuthContext);\n};\nexport default AuthProvider;\nexport { useAuth };","map":{"version":3,"names":["defaultAuthState","isLoading","isAuthenticated","user","roleAssignments","getAccessToken","Promise","resolve","logout","login","createAuthContext","React","createContext","AuthContext","Auth0AuthProvider","_ref","children","claimsNamespace","loginAutomatically","_useAuth","useAuth0","loginWithRedirect","getIdTokenClaims","getAccessTokenSilently","_useState","useState","setRoleAssignments","useEffect","getClaims","then","idTokenClaims","e","reject","undefined","createElement","Provider","value","redirectUri","AuthProvider","auth0Config","auth0ClaimsNamespace","_ref$loginAutomatical","Auth0Provider","Object","assign","useRefreshToken","cacheLocation","window","location","hostname","indexOf","useAuth","useContext"],"sources":["/Users/ujee/Documents/wikimedia-app/node_modules/@entur/auth-provider/src/common.ts","/Users/ujee/Documents/wikimedia-app/node_modules/@entur/auth-provider/src/Auth0AuthProvider.tsx","/Users/ujee/Documents/wikimedia-app/node_modules/@entur/auth-provider/src/AuthProvider.tsx","/Users/ujee/Documents/wikimedia-app/node_modules/@entur/auth-provider/src/index.tsx"],"sourcesContent":["import React from 'react'\nimport { Auth, User } from './typings'\n\nexport const defaultAuthState = {\n  isLoading: false,\n  isAuthenticated: false,\n  user: null,\n  roleAssignments: null,\n  getAccessToken: () => Promise.resolve(''),\n  logout: () => {},\n  login: () => {}\n}\n\nfunction createAuthContext<T extends User>() {\n  return React.createContext<Auth<T>>(defaultAuthState)\n}\n\nexport const AuthContext = createAuthContext();\n\n","import React, { useEffect, useState } from 'react'\nimport { useAuth0 } from '@auth0/auth0-react'\nimport { AuthContext } from './common'\n\ninterface Props {\n  children?: React.ReactNode\n  claimsNamespace?: string\n  loginAutomatically?: boolean\n}\n\nexport const Auth0AuthProvider = ({\n  children,\n  claimsNamespace,\n  loginAutomatically\n}: Props) => {\n  const {\n    isLoading,\n    isAuthenticated,\n    user,\n    loginWithRedirect,\n    getIdTokenClaims,\n    getAccessTokenSilently,\n    logout\n  } = useAuth0()\n  const [roleAssignments, setRoleAssignments] = useState<any>()\n\n  useEffect(() => {\n    const getClaims = async () => {\n      const idTokenClaims = await getIdTokenClaims()\n      if (idTokenClaims) {\n        setRoleAssignments(idTokenClaims[claimsNamespace!])\n      }\n    }\n    if (isAuthenticated && claimsNamespace !== undefined) {\n      getClaims()\n    }\n  }, [isAuthenticated, getIdTokenClaims])\n\n  if (!isAuthenticated && !isLoading) {\n    if (loginAutomatically) {\n      loginWithRedirect()\n    }\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuthenticated,\n        isLoading,\n        user,\n        roleAssignments,\n        getAccessToken: getAccessTokenSilently,\n        logout,\n        login: (redirectUri?: string) => loginWithRedirect({ redirectUri })\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n","import React from 'react'\nimport { Auth0Provider } from '@auth0/auth0-react'\nimport { Auth0AuthProvider } from './Auth0AuthProvider'\nimport { Auth0Config } from './typings'\n\ninterface Props {\n  keycloakConfigUrl?: string\n  auth0Config?: Auth0Config\n  auth0ClaimsNamespace?: string\n  children?: React.ReactNode\n  loginAutomatically?: boolean\n}\n\nexport const AuthProvider = ({\n  auth0Config,\n  auth0ClaimsNamespace,\n  children,\n  loginAutomatically = true\n}: Props) => {\n  return (\n    <Auth0Provider\n      useRefreshToken\n      cacheLocation={\n        window.location.hostname.indexOf('localhost') > -1\n          ? 'localstorage'\n          : 'memory'\n      }\n      {...auth0Config!}\n    >\n      <Auth0AuthProvider\n        claimsNamespace={auth0ClaimsNamespace}\n        loginAutomatically={loginAutomatically}\n      >\n        {children}\n      </Auth0AuthProvider>\n    </Auth0Provider>\n  )\n}\n","import { useContext } from 'react'\nimport { AuthContext } from './common'\n\nexport { AuthProvider as default } from './AuthProvider'\n\nexport const useAuth = () => useContext(AuthContext)\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}